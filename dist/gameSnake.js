/* wzwgame v1.0.0 by Microanswer,web:http://test.microanswer.cn/wzwgame/index.html */
!function(t){var e=t.WzwScreen,o=t.WzwBomb,s=1,i=2,n=3,h=4;function a(t,e,o,s,i){this.offsetRow=t,this.offsetCol=e,this.direction=o,this.pre=s,this.next=i}function r(){this.timeSpace=320,this.initPreview()}a.prototype.pushFood=function(t){this.food=t},a.prototype.update=function(){var t;if(this.food?(t=this.next,this.next=new a(this.food[0],this.food[1],void 0,this,t),t.pre=this.next,this.food=void 0):this.next&&this.next.update(),this.pre)this.offsetRow=this.pre.offsetRow,this.offsetCol=this.pre.offsetCol;else switch(this.nextDirection&&(this.direction=this.nextDirection,this.nextDirection=void 0),this.direction){case s:--this.offsetRow;break;case h:--this.offsetCol;break;case n:this.offsetRow+=1;break;case i:this.offsetCol+=1}},a.prototype.applyAtoms=function(t){this.next&&this.next.applyAtoms(t);try{t[this.offsetRow][this.offsetCol]=1}catch(t){}},a.prototype.turnTo=function(t){this.pre||(this.direction===n&&t!==s||this.direction===h&&t!==i||this.direction===i&&t!==h||this.direction===s&&t!==n)&&(this.nextDirection=t)},a.prototype.isAtomsIn=function(t,e){return this.offsetRow===t&&this.offsetCol===e||!!this.next&&this.next.isAtomsIn(t,e)},r.prototype.onRegLaunch=function(t){this.launch=t},r.prototype.getPreviewAtoms=function(){var t;return Date.now()-(this.previewLastTime||0)>=this.previewTimeSpace&&(t=this.previewArr[this.previewIndex],this.previewIndex++,this.previewIndex>=this.previewArr.length-1&&(this.previewIndex=0),this.previewLastTime=Date.now()),t},r.prototype.onLaunch=function(){var t=parseInt(this.launch.screen.option.atomRowCount/2),e=parseInt(this.launch.screen.option.atomColCount/2);this.snakeHead=new a(t,e,s,void 0,void 0);var o=new a(this.snakeHead.offsetRow+1,e,null,this.snakeHead,void 0);(this.snakeHead.next=o).next=new a(o.offsetRow+1,e,null,o,void 0),this.food=this.makeFood(),this.live=!0,this.paused=!1,this.score=0},r.prototype.onUpdate=function(){var t;return this.atoms=this.launch.screen.makeNewArr(),this.snakeHead&&(Date.now()-(this.gameLastTime||0)>(this.turbo?30:this.timeSpace)&&(this.food&&this.snakeHead.isAtomsIn(this.food[0],this.food[1])&&(this.score+=1,this.launch.screen.setScore(this.score),this.snakeHead.pushFood(this.food),this.food=this.makeFood()),this.live&&!this.paused&&this.snakeHead.update(),(this.snakeHead.next.isAtomsIn(this.snakeHead.offsetRow,this.snakeHead.offsetCol)||this.snakeHead.offsetRow<0||this.snakeHead.offsetCol<0||this.snakeHead.offsetRow>=this.launch.screen.option.atomRowCount||this.snakeHead.offsetCol>=this.launch.screen.option.atomColCount)&&(this.live=!1),this.live||this.bomb||((t=this).bomb=new o({offsetRow:t.snakeHead.offsetRow-2,offsetCol:t.snakeHead.offsetCol-2,onEnd:function(){t.uiGameover()}})),this.gameLastTime=Date.now()),this.atoms&&(this.food&&60<Date.now()-(this.foodLastTime||0)&&(this.atoms[this.food[0]][this.food[1]]=1===this.atoms[this.food[0]][this.food[1]]?0:1,this.foodLastTime=Date.now()),this.snakeHead.applyAtoms(this.atoms))),this.atoms&&this.bomb&&(this.bomb.update(),e.mergeArr(this.bomb.getCurrentFrame(),this.atoms,this.bomb.offsetRow,this.bomb.offsetCol)),this.atoms},r.prototype.onUpdateStatus=function(){},r.prototype.onDestroy=function(){this.launch.screen.setScore(0),this.snakeHead=void 0,this.bomb=void 0,this.live=!1,this.turbo=!1,this.food=void 0,this.paused=!1,this.launch.exitCurentGame()},r.prototype.onKeyup=function(t){"rotate"===t&&(this.turbo=!1)},r.prototype.onKeyDown=function(t){if("start"===t&&(this.paused=!this.paused,this.launch.screen.setPause(this.paused)),this.snakeHead){if(this.paused)return;switch(t){case"up":this.snakeHead.turnTo(s);break;case"right":this.snakeHead.turnTo(i);break;case"down":this.snakeHead.turnTo(n);break;case"left":this.snakeHead.turnTo(h);break;case"rotate":this.turbo=!0}}},r.prototype.initPreview=function(){this.previewIndex=0,this.previewTimeSpace=200,this.previewArr=[[[0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,1,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,1,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,0,0,0,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,1,0,0,0],[0,1,1,1,1,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,1,0,0,0,0,0,1,0,0,0],[0,1,1,1,1,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,1,1,1,1,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,1,1,1,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,1,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,1,1,1,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1,1,1,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,1,1,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,1,0],[0,0,1,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1,1,1,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,1,1,0],[0,0,1,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1,1,1,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,1,1,1,0],[0,0,1,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1,1,1,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,1,1,1,1,0],[0,0,1,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1,1,1,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,1,1,1,1,1,0],[0,0,1,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1,1,1,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,1,1,1,1,1,1,0],[0,0,1,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1,1,1,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]]]},r.prototype.makeFood=function(){var t=[e.random(0,this.launch.screen.option.atomRowCount),e.random(0,this.launch.screen.option.atomColCount)];if(this.snakeHead)for(;this.snakeHead.isAtomsIn(t[0],t[1]);)t=[e.random(0,this.launch.screen.option.atomRowCount),e.random(0,this.launch.screen.option.atomColCount)];return t},r.prototype.uiGameover=function(){var o=this;this.launch.screen.playAnim(e.ANIM.B2T,function(t,e){0===e&&o.onDestroy()})},t.Snake=r}(window);